<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/PopGen.jl/blog/rss.xml" title="PopGen.jl Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/PopGen.jl/blog/atom.xml" title="PopGen.jl Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="PopGen.jl" href="/PopGen.jl/opensearch.xml"><title data-react-helmet="true">Comparison | PopGen.jl</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Comparison | PopGen.jl"><meta data-react-helmet="true" name="description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><meta data-react-helmet="true" property="og:description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><meta data-react-helmet="true" property="og:url" content="https://pdimens.github.io/PopGen.jl/docs/getting_started/comparison"><link data-react-helmet="true" rel="shortcut icon" href="/PopGen.jl/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://pdimens.github.io/PopGen.jl/docs/getting_started/comparison"><link rel="stylesheet" href="/PopGen.jl/styles.82d9d3d0.css">
<link rel="preload" href="/PopGen.jl/styles.59a310a6.js" as="script">
<link rel="preload" href="/PopGen.jl/runtime~main.cba83e53.js" as="script">
<link rel="preload" href="/PopGen.jl/main.7ccefe92.js" as="script">
<link rel="preload" href="/PopGen.jl/1.6948bf9e.js" as="script">
<link rel="preload" href="/PopGen.jl/2.234dd731.js" as="script">
<link rel="preload" href="/PopGen.jl/75.d6a307ab.js" as="script">
<link rel="preload" href="/PopGen.jl/78.bf38aae8.js" as="script">
<link rel="preload" href="/PopGen.jl/935f2afb.edaf8fb2.js" as="script">
<link rel="preload" href="/PopGen.jl/17896441.e7aa732e.js" as="script">
<link rel="preload" href="/PopGen.jl/99164b56.06aee057.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbarHideable_17Wu navbarHidden_19ww"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/PopGen.jl/"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">PopGen.jl</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/PopGen.jl/docs/">Docs</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/getting_started/about">About</a><a class="navbar__item navbar__link" href="/PopGen.jl/blog">Blog</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/latest">What&#x27;s New</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/PopGen.jl/docs/getting_started/quickstart">Quickstart</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/getting_started/community">Get Involved</a><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/PopGen.jl/"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">PopGen.jl</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/PopGen.jl/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/docs/getting_started/about">About</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/docs/getting_started/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/docs/latest">What&#x27;s New</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/docs/getting_started/community">Get Involved</a></li><li class="menu__list-item"><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy sidebarWithHideableNavbar_CROi"><a tabindex="-1" class="sidebarLogo_xFc8" href="/PopGen.jl/"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_YANc themedImage--light_3CMI"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_YANc themedImage--dark_3ARp"><strong>PopGen.jl</strong></a><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/julia_primer">A quick Julia primer</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/PopGen.jl/docs/getting_started/comparison">Comparison</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/types">PopObj and PopData types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/other_types">Other data types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/datasets">Provided datasets</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">File I/O</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/file_import">Reading in data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/file_write">Writing data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/delimited">Delimited format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/genepop">Genepop format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/structure">Structure format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/vcf">Variant Call Format</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">PopData Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/manipulate">Start here</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/accessing">Accessing elements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/add_info">Adding Information</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/exclusion">Data Exclusion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/populations">Location and population data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/viewdata">Viewing data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/basics/dataexploration">Data exploration</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Analyses</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/analyses/hardyweinberg">Hardy-Weinberg Equilibrium</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/analyses/relatedness">Relatedness (Kinship)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Simulations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/simulations/simulate_samples">Simulating Samples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/simulations/breeding_crosses">Breeding Crosses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/simulations/sibship_simulations">Sibling Pairs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/api">API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/allelefreq">AlleleFreq.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/datasets">Datasets.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/dataexploration">DataExploration.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/delimited">Delimited.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/genepop">Genepop.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/hardyweinberg">HardyWeinberg.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/heterozygosity">Heterozygosity.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/ioutils">ioUtils.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/manipulate">Manipulate.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/pairwiserelatedness">PairwiseRelatedness.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/permutations">Permutations.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/read">Read.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/relatednessmoments">RelatednessMoments.jl</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">PopGenSims</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/PopGenSims/popgensims_cross">Cross.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/PopGenSims/popgensims_samples">Samples.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/PopGenSims/popgensims_sibship">Sibship.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/PopGenSims/popgensims_utils">Utils.jl</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/structure">Structure.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/summaryinfo">SummaryInfo.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/types">Types.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/utils">Utils.jl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/variantcall">VariantCall.jl</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2WRA"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_CoMu"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Comparison</h1></header><div class="markdown"><p>There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:</p><ol><li>fast(er)</li><li>written in a single language</li><li>easy to use</li></ol><p>So, we&#x27;d like to prove that Julia and PopGen.jl actually achieves that by showing a few benchmarks comparing PopGen.jl to <code>adegenet</code> and <code>pegas</code>, which along with <code>ape</code> are arguably the most commonly used and robust population genetic packages available. It&#x27;s worth mentioning that we ourselves use and have published work incorporating these packages, and are incredibly grateful for the work invested in those packages. We appreciate those folks and have tremendous respect and envy for the work they continue to do! Here are links to <a href="https://github.com/thibautjombart/adegenet" target="_blank" rel="noopener noreferrer">adegenet</a>, <a href="https://academic.oup.com/bioinformatics/article/26/3/419/215731/" target="_blank" rel="noopener noreferrer">pegas</a>, and <a href="https://cran.r-project.org/package=ape" target="_blank" rel="noopener noreferrer">ape</a>.  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="benchmarks"></a>Benchmarks<a class="hash-link" href="#benchmarks" title="Direct link to heading">#</a></h2><p>To make this a practical comparison, we&#x27;re going to use the <code>gulfsharks</code> data because it is considerably larger (212 samples x 2213 loci) than <code>nancycats</code> (237 x 9) and a bit more of a &quot;stress test&quot;.  All benchmarks in R are performed using the <code>microbenchmark</code> package, and  <code>BenchmarkTools</code> are used for Julia.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1shy tabs__item--active">load Julia packages</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1shy">load R packages</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-julia codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">using BenchmarkTools, PopGen</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-r codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">library(adegenet)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">library(pegas)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">library(hierfstat)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">library(microbenchmark)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div></div><p>As a note, the reported benchmarks are being performed on a 64-bit Manjaro Linux system on a nothing-special Lenovo Thinkbook 14S  with 8gigs of RAM and a 8th gen Intel i5 mobile processor. <strong>Note:</strong> all of the Julia benchmarks, unless explicitly stated, are performed single-threaded (i.e. not parallel, distributed, or GPU).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="reading-in-data"></a>Reading in data<a class="hash-link" href="#reading-in-data" title="Direct link to heading">#</a></h3><p>Since <code>gulfsharks</code> is shamelessly provided in PopGen.jl, we will just load it with <code>genepop()</code>.  If you would like to try this yourself in R, find the <code>gulfsharks.gen</code> file in the package repository under <code>/data/source/gulfsharks.gen</code>. Since the file importer now uses CSV.jl to read files, there is one step of the genepop parser that is multithreaded. However, the majority of the data parsing (formatting the raw data into a correct PopData structure) occurs using a single thread. This R benchmark will take a few minutes. Consider making some tea while you wait.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1shy tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1shy">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">@benchmark sharks = genepop(&quot;data/source/gulfsharks.gen&quot;, silent = true)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  330.58 MiB</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  6905285</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     806.202 ms (5.91% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  median time:      884.887 ms (5.61% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  mean time:        910.722 ms (5.41% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     1.071 s (4.82% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  samples:          6</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-r codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(read.genepop(file = &quot;/home/pdimens/gulfsharks.gen&quot;, ncode = 3L, quiet = TRUE))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> read.genepop(file = &quot;/home/pdimens/gulfsharks.gen&quot;, ncode = 3L, quiet = FALSE)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      min       lq     mean   median       uq      max neval</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> 5.670637 6.218719 6.745065 6.387936 7.019667 9.173005   100</span></div><div class="token-line" style="color:#393A34"><span class="token plain">microbenchmark)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div></div><p><img alt="import plot" src="/PopGen.jl/assets/images/speedplot-a0dcb588e1923961a9aaf9e183490011.png"></p><p>Comparing averages, PopGen.jl clocks in at <code>910ms</code> versus adegenet&#x27;s <code>6.745s</code> , so ~7.4x faster.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="popdata-vs-genind-size"></a><code>PopData</code> vs <code>genind</code> size<a class="hash-link" href="#popdata-vs-genind-size" title="Direct link to heading">#</a></h3><p>It was pretty tricky to come up with a sensible/efficient/convenient data structure for PopGen.jl, and while the two-DataFrames design might not seem like it took a lot of effort, we ultimately decided that the column-major style and available tools, combined with careful genotype Typing was a decent &quot;middle-ground&quot; of ease-of-use vs performance.</p><p><em>Anyway</em>, it&#x27;s important to understand how much space your data will take up in memory (your RAM) when you load it in, especially since data&#x27;s only getting bigger! Keep in mind that <code>gulfsharks</code> in PopGen.jl also provides lat/long data, which <em>should</em> inflate the size of the object somewhat compared to the <code>genind</code>, which we won&#x27;t add any location data to.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1shy tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1shy">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-julia codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">julia&gt; Base.summarysize(sharks)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">3527765</span></div><div class="token-line" style="color:#393A34"><span class="token plain">#bytes</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-r codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&gt; object.size(gen)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">5331536 bytes</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div></div><p><img alt="data structure plot" src="/PopGen.jl/assets/images/objectplot-ec422864760c5133e262eec866a62f7c.png"></p><p>The original file is <code>3.2mb</code> (the horizontal line), and our <code>PopData</code> object takes up ~<code>3.5mb</code> in memory (300kb larger than the source file) versus the ~<code>5.3mb</code> of a <code>genind</code>, which is ~1.5x larger than the source file. That&#x27;s quite a big difference!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="summary-statistics"></a>Summary statistics<a class="hash-link" href="#summary-statistics" title="Direct link to heading">#</a></h3><p>The obvious hallmark of population genetics is heterozygosity values and F-statistics. Here we&#x27;ll compare the basic summary statistics that can be produced using <code>hierfstat</code> and <code>PopGen.jl</code>.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1shy tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1shy">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-julia codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">julia&gt; @benchmark summary(sharks, by = &quot;global&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  88.42 MiB</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  1307128</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     151.963 ms (0.00% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  median time:      171.484 ms (7.60% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  mean time:        172.456 ms (6.08% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     186.606 ms (7.04% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  samples:          29</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-r codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(basic.stats(gen))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span></div><div class="token-line" style="color:#393A34"><span class="token plain">             expr      min       lq     mean</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> basic.stats(gen) 4.276996 4.425934 4.618796</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   median       uq      max neval</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> 4.609901 4.706666 5.292831   100</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div></div><p><img alt="summary statistics plot" src="/PopGen.jl/assets/images/sumstatplot-598f7c700e09791e891c6f574ce057fc.png"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>171ms</code> versus hierfstat&#x27;s <code>4.6s</code>, which is ~<strong>27x</strong> faster on these data. However, when testing on a data that was 401 samples x 5331 loci (not shown), PopGen.jl performed 36.6x faster. This gap seems to increase the larger the data is, but we have not tested the upper limits of this.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="chi-squared-test-for-hwe"></a>Chi-squared test for HWE<a class="hash-link" href="#chi-squared-test-for-hwe" title="Direct link to heading">#</a></h3><p>This is a classic population genetics test and a relatively simple one. The R benchmark will take a while again, so if you&#x27;re following along, this would be a good time to reconnect with an old friend.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1shy tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1shy">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-julia codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">julia&gt; @benchmark hwe_test(sharks)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  46.22 MiB</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  1050525</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     145.476 ms (0.00% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  median time:      179.146 ms (4.35% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  mean time:        176.142 ms (3.56% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     204.813 ms (0.00% GC)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  samples:          29</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-r codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(hw.test(gen, B = 0))</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span></div><div class="token-line" style="color:#393A34"><span class="token plain">                expr      min       lq     mean   median       uq      max neval</span></div><div class="token-line" style="color:#393A34"><span class="token plain"> hw.test(gen, B = 0) 5.100298 5.564807 6.265948 5.878842 6.917006 8.815179   100</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div></div><p><img alt="chi squared plot" src="/PopGen.jl/assets/images/chisqplot-94c0d817b3b77543f63ae472bbde4d6a.png"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>176ms</code> versus adegenet&#x27;s <code>6.3s</code>, so ~<strong>35.8x</strong> faster on these data(!)</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/pdimens/popgen.jl/edit/documentation/docs/getting_started/comparison.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-10-20T19:51:09.000Z" class="docLastUpdatedAt_1Qna">10/20/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/PopGen.jl/docs/getting_started/julia_primer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« A quick Julia primer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/PopGen.jl/docs/getting_started/types"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">PopObj and PopData types Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#benchmarks" class="table-of-contents__link">Benchmarks</a><ul><li><a href="#reading-in-data" class="table-of-contents__link">Reading in data</a></li><li><a href="#popdata-vs-genind-size" class="table-of-contents__link"><code>PopData</code> vs <code>genind</code> size</a></li><li><a href="#summary-statistics" class="table-of-contents__link">Summary statistics</a></li><li><a href="#chi-squared-test-for-hwe" class="table-of-contents__link">Chi-squared test for HWE</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Pavel Dimens & Jason Selwyn. Built with Docusaurus. Rawr!</div></div></div></footer></div>
<script src="/PopGen.jl/styles.59a310a6.js"></script>
<script src="/PopGen.jl/runtime~main.cba83e53.js"></script>
<script src="/PopGen.jl/main.7ccefe92.js"></script>
<script src="/PopGen.jl/1.6948bf9e.js"></script>
<script src="/PopGen.jl/2.234dd731.js"></script>
<script src="/PopGen.jl/75.d6a307ab.js"></script>
<script src="/PopGen.jl/78.bf38aae8.js"></script>
<script src="/PopGen.jl/935f2afb.edaf8fb2.js"></script>
<script src="/PopGen.jl/17896441.e7aa732e.js"></script>
<script src="/PopGen.jl/99164b56.06aee057.js"></script>
</body>
</html>